
== Declarative recipes

image::declarative.jpg[background, size=cover]

[.notes]
--
Un recette d√©claratice est en fait juste un format de d√©claration de recette sans avoir √† √©crire du code.
--

[%notitle]
=== Comment et o√π ?


[.fragment]
Dans un fichier qui doit s'appeler `rewrite.yml`

[.fragment]
√Ä la racine d'un projet.
[.fragment]
Dans le r√©pertoire `META-INF/rewrite`

[.notes]
--
Attention, pas `yaml`
Projet Maven ou Gradle...
--

[%notitle]
=== Et √ßa ressemble √† ?

[source,yaml,highlight="3|4..10|11..13|14..17|23..24|26..34"]
----
---
type: specs.openrewrite.org/v1beta/recipe
name: org.acme.RemovesThatToxicDependency
displayName: Removes that toxic dependency
description: |
  Migrate from AcmeToxic ‚ò†Ô∏è to AcmeHealthy üòá,
  removes dependencies and migrates code.
tags:
  - acme
  - toxic
preconditions:
  - org.openrewrite.text.Find:
      find: org.acme.toxic.BigDecimalUtils
recipeList:
  - org.openrewrite.java.ChangeMethodTargetToStatic:
      methodPattern: org.acme.toxic.BigDecimalUtils valueOf(..)
      fullyQualifiedTargetTypeName: java.math.BigDecimal
  - org.openrewrite.maven.RemoveUnusedProperties:
      properties: .*toxic\.version
  - org.openrewrite.maven.RemoveDependency:
      groupId: com.github.jtama
      artifactId: toxic-library
  - org.acme.VousAllezVoirCeQueVousAllezVoir
---
type: specs.openrewrite.org/v1beta/recipe
name: org.acme.VousAllezVoirCeQueVousAllezVoir
displayName: √áa va vous √©pater
description: |
  Rech. proj. pr proj. priv. Self Dem. Brt. Poss. S‚Äôadr. √† l‚Äôh√¥. Mart
tags:
  - acme
recipeList:
  - com.github.jtama.openrewrite.RemoveFooBarUtilsIsEmpty
  - com.github.jtama.openrewrite.RemoveFooBarUtilsStringFormatted
  - com.github.jtama.openrewrite.UseObjectsCompare
----

[.notes]
--
Et on imagine ici que la derni√®re recette est accessible ailleurs.
--

[%notitle]
=== Et on l'ex√©cute comme √ßa

[.fragment]
[source,bash,highlight="2..3|4..5"]
----
mvn -U org.openrewrite.maven:rewrite-maven-plugin:run \
    -Drewrite.activeRecipes=\
      org.acme.RemovesThatToxicDependency
----

=== Distribution

Inclure ce fichier dans un module maven fant√¥me...


[.lesson]
=== !

- ‚úÖ Conna√Ætre l'outil
- ‚úÖ Savoir lire une carte
- ‚úÖ Savoir d√©marrer le v√©hicule
- ‚úÖ Savoir conduire en ville
